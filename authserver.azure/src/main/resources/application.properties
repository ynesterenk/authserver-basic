# Spring Configuration for Azure Functions Authorization Server
spring.application.name=authserver-azure
spring.profiles.active=local

# Logging Configuration
logging.level.root=INFO
logging.level.com.example.auth=DEBUG
logging.level.com.azure=WARN
logging.level.org.springframework=INFO
logging.level.org.apache.http=WARN

# Azure Key Vault Configuration
azure.keyvault.url=${KEY_VAULT_URL:https://kv-authserver-dev.vault.azure.net/}
azure.keyvault.tenant-id=${AZURE_TENANT_ID:}
azure.keyvault.client-id=${AZURE_CLIENT_ID:}
azure.keyvault.enabled=${AZURE_KEYVAULT_ENABLED:true}

# Cache Configuration
cache.ttl.minutes=${CACHE_TTL_MINUTES:5}
cache.max.size=${CACHE_MAX_SIZE:1000}
cache.user.enabled=${CACHE_USER_ENABLED:true}
cache.oauth-client.enabled=${CACHE_OAUTH_CLIENT_ENABLED:true}

# OAuth2 Configuration
oauth2.token.max-expiration-seconds=${OAUTH2_TOKEN_MAX_EXPIRATION_SECONDS:7200}
oauth2.token.default-expiration-seconds=${OAUTH2_TOKEN_DEFAULT_EXPIRATION_SECONDS:3600}
oauth2.security.enable-client-status-check=${OAUTH2_SECURITY_ENABLE_CLIENT_STATUS_CHECK:true}
oauth2.introspection.cache-ttl-seconds=${OAUTH2_INTROSPECTION_CACHE_TTL_SECONDS:300}

# JWT Configuration
jwt.signing.key-id=${JWT_SIGNING_KEY_ID:jwt-signing-key}
jwt.issuer=${JWT_ISSUER:https://authserver.example.com}
jwt.audience=${JWT_AUDIENCE:api://default}
jwt.token.expiration-seconds=${JWT_TOKEN_EXPIRATION_SECONDS:3600}
jwt.algorithm=${JWT_ALGORITHM:RS256}

# Argon2 Password Hashing Configuration
argon2.memory=${ARGON2_MEMORY:65536}
argon2.iterations=${ARGON2_ITERATIONS:3}
argon2.parallelism=${ARGON2_PARALLELISM:1}
argon2.hash-length=${ARGON2_HASH_LENGTH:32}
argon2.salt-length=${ARGON2_SALT_LENGTH:16}

# Security Configuration
security.enable-timing-attack-protection=${SECURITY_ENABLE_TIMING_ATTACK_PROTECTION:true}
security.max-authentication-attempts=${SECURITY_MAX_AUTHENTICATION_ATTEMPTS:5}
security.lockout-duration-minutes=${SECURITY_LOCKOUT_DURATION_MINUTES:15}

# Application Insights Configuration
applicationinsights.connection.string=${APPLICATIONINSIGHTS_CONNECTION_STRING:}
applicationinsights.sampling.percentage=${APPLICATIONINSIGHTS_SAMPLING_PERCENTAGE:100}

# Local Development Configuration
---
spring.config.activate.on-profile=local

# Local file-based repositories
repository.user.type=file
repository.oauth-client.type=file
repository.user.file.path=classpath:local-users.json
repository.oauth-client.file.path=classpath:local-oauth-clients.json

# Disable Azure Key Vault for local development
azure.keyvault.enabled=false

# Local JWT signing (for development only)
jwt.signing.local-key-enabled=true
jwt.signing.local-key-algorithm=RS256

---
spring.config.activate.on-profile=dev

# Azure Key Vault repositories for development environment  
repository.user.type=keyvault
repository.oauth-client.type=keyvault
azure.keyvault.enabled=true

---
spring.config.activate.on-profile=prod

# Production Azure Key Vault repositories
repository.user.type=keyvault
repository.oauth-client.type=keyvault
azure.keyvault.enabled=true

# Production security settings
oauth2.security.enable-client-status-check=true
security.enable-timing-attack-protection=true
applicationinsights.sampling.percentage=50 